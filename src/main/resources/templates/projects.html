<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title ?: 'Проекты'} + ' - Hackathon Platform'">Проекты - Hackathon Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root { --primary-color: #C56344; --background-color: #242424; --card-background-color: #2E2E2E; --text-color: #E5DCC5; --accent-color: #E49A57; --border-color: #404040; }

        body { font-family: 'Inter', sans-serif; margin: 0; background-color: var(--background-color); color: var(--text-color); }

        .top-nav { background-color: var(--background-color); border-bottom: 1px solid var(--border-color); padding: 15px 0; }
        .top-nav .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; align-items: center; }
        .top-nav a { color: var(--text-color); text-decoration: none; margin-right: 20px; font-weight: 600; transition: color 0.3s ease; }
        .top-nav a:hover { color: var(--accent-color); }
        .logout-form { margin-left: auto; }
        .logout-btn { background: none; border: 1px solid var(--primary-color); color: var(--primary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: 'Inter', sans-serif; font-size: 0.9em; font-weight: 600; transition: all 0.3s ease; }
        .logout-btn:hover { background-color: var(--primary-color); color: var(--background-color); }

        main { max-width: 900px; margin: 40px auto; padding: 0 20px; }
        h1, h2 { color: var(--text-color); }
        h1 { text-align: center; margin-bottom: 30px; font-size: 2.5em; }

        .content-card { background-color: var(--card-background-color); padding: 30px; margin-bottom: 25px; border-radius: 8px; border: 1px solid var(--border-color); }
        .content-card h2 { margin-top: 0; color: var(--accent-color); border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }

        .alert { padding: 15px; margin-bottom: 20px; border-radius: 5px; border: 1px solid transparent; }
        .alert-success { background-color: #3e5c3e; border-color: #6a994e; color: #d4edda; }
        .alert-error { background-color: #5c2c2c; border-color: #9c4c4c; color: #f5c6cb; }

        .item-list { display: grid; grid-template-columns: 1fr; gap: 15px; list-style: none; padding: 0;}
        .item-card { border: 1px solid var(--border-color); background-color: var(--background-color); padding: 20px; border-radius: 8px; }
        .item-card h3 { margin: 0 0 5px; color: var(--text-color); }
        .item-card p { margin: 5px 0; font-size: 0.95em; opacity: 0.8; }
        .item-card strong { opacity: 1; color: var(--accent-color); }

        form div { margin-bottom: 15px; }
        form label { display: block; font-weight: 600; margin-bottom: 5px; opacity: 0.9; }
        form input, form textarea, form select { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 4px; box-sizing: border-box; background-color: var(--background-color); color: var(--text-color); font-size: 1em; }
        form input:focus, form textarea:focus, form select:focus { outline: none; border-color: var(--primary-color); }

        .btn { display: inline-block; color: var(--background-color); background-color: var(--primary-color); padding: 12px 25px; border-radius: 5px; text-decoration: none; font-weight: 600; border: none; cursor: pointer; text-align: center; font-size: 1.1em; width: 100%; box-sizing: border-box; transition: background-color 0.3s ease; }
        .btn:hover { background-color: #b1563a; }

        .form-link a { color: var(--accent-color); font-weight: 600; text-decoration: none; }
    </style>
</head>
<body>

<header class="top-nav">
    <div class="container">
        <a th:href="@{/}">Главная</a>
        <a th:href="@{/events}">Хакатоны</a>
        <a th:href="@{/teams}">Команды</a>
        <div sec:authorize="isAuthenticated()" class="logout-form">
            <form th:action="@{/logout}" method="post">
                <button type="submit" class="logout-btn">Выйти</button>
            </form>
        </div>
    </div>
</header>

<main>
    <h1>Управление проектами</h1>

    <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

    <section class="content-card">
        <h2>Мои проекты</h2>
        <div th:if="${myProjects.empty}">
            <p>У вас пока нет проектов. Создайте свой первый проект в форме ниже!</p>
        </div>
        <div th:unless="${myProjects.empty}" class="item-list">
            <div th:each="project : ${myProjects}" class="item-card">
                <h3 th:text="${project.name}">Название проекта</h3>
                <p><strong>Команда:</strong> <span th:text="${project.team.name}">Название команды</span></p>
                <p th:if="${project.description}" th:text="${project.description}">Описание проекта.</p>
            </div>
        </div>
    </section>

    <section class="content-card">
        <h2>Создать новый проект</h2>
        <div th:if="${myTeams.empty}" class="form-link">
            <p>Чтобы создать проект, вы должны сначала <a th:href="@{/events}">зарегистрироваться на хакатон</a> и создать команду.</p>
        </div>
        <form th:unless="${myTeams.empty}" th:action="@{/projects/create}" method="post">
            <div>
                <label for="teamId">Выберите команду:</label>
                <select id="teamId" name="teamId" required>
                    <option th:each="team : ${myTeams}"
                            th:value="${team.id}"
                            th:text="${team.name} + ' (' + ${team.event.name} + ')'">
                    </option>
                </select>
            </div>
            <div>
                <label for="projectName">Название проекта:</label>
                <input type="text" id="projectName" name="projectName" placeholder="Например, 'AI Pet Feeder'" required>
            </div>
            <div>
                <label for="projectDescription">Краткое описание:</label>
                <textarea id="projectDescription" name="projectDescription" rows="4" placeholder="Расскажите о ключевой идее вашего проекта"></textarea>
            </div>
            <button type="submit" class="btn">Создать проект</button>
        </form>
    </section>
</main>

</body>
</html>